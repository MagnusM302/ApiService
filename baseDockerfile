# BaseImage.Dockerfile
FROM mcr.microsoft.com/windows/servercore:ltsc2019

RUN powershell -Command \
    $ErrorActionPreference = 'Stop'; \
    $ProgressPreference = 'SilentlyContinue'; \
    Invoke-WebRequest -OutFile python.exe -Uri https://www.python.org/ftp/python/3.10.0/python-3.10.0-amd64.exe; \
    Start-Process -FilePath python.exe -ArgumentList '/quiet InstallAllUsers=1 PrependPath=1 TargetDir=C:\Python310' -Wait; \
    Remove-Item python.exe -Force; \
    if (-not (Test-Path 'C:\Python310\python.exe')) { Write-Output 'Python installation failed'; exit 1 }

WORKDIR /app
RUN C:\Python310\python.exe -m pip install --upgrade pip
